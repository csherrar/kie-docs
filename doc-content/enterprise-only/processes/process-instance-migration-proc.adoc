[id='process-instance-migration-proc']
= Process instance migration

Process instance migration (PIM) is a Technology Preview standalone service containing a user interface and a backend, and packaged as a Thorntail uber-jar. You can use the process instance migration service to define the migration between two different process definitions, known as a migration plan. The user can then apply the migration plan to the running process instance in a specific process server.

For more information about the process instance migration standalone service, see https://github.com/kiegroup/droolsjbpm-integration/tree/master/process-migration-service[Process Instance Migration Service] in https://github.com/kiegroup[_KIE (Drools, OptaPlanner and jBPM )_].

== Installing the process instance migration service

You can test the process instance migration service by cloning the GitHub repo, running the service, and accessing the service bin a browser.

.Prerequisites
* You have defined processes in a backuped {PRODUCT} development environment.

.Procedure
. Clone the https://github.com/kiegroup/droolsjbpm-integration[Drools and jBPM integration repository] from GitHub to your system:
+
----
$ git clone git@github.com:kiegroup/droolsjbpm-integration.git
----
. Navigate to the cloned directory:
+
----
$ cd droolsjbpm-integration
----
. Checkout the `7.23.x` branch of the repository:
+
----
$ git checkout 7.23.x
----
. Navigate to `process-migration-service/frontend`:
+
----
$ cd process-migration-service/frontend
----
. Launch the process instance migration service:
+
----
$ npm start
----
+
[NOTE]
====
If required, install `npm`:
+
----
$ npm install
----
====
. Once the service is up and running, open the following address in a web browser:
+
----
localhost:3000
----

== Creating a migration plan

You can use the process instance migration service to define the migration between two different process definitions, known as a migration plan.

.Prerequisites
* You have defined processes in a backuped {PRODUCT} development environment.
* The process instance migration service is running.

.Procedure
. Open the following address in a web browser:
+
----
localhost:3000
----
. Log in to the Process Instance Migration service.
. In the upper right corner of the *Process Instance Migration* page, from the KIE Service list select the KIE Service you want to add a migration plan for.
. Click *Add Plan*. The *Add Migration Plan Wizard* window opens.
. In the *Name* field, enter a name for the migration plan.
. Optional: In the *Description* field, enter a description for the migration plan.
. Click *Next*.
. In the *Source ContainerID* field, enter the source container ID.
. In the *Source ProcessId* field, enter the source process ID.
. Click *Copy Source To Target*.
. In the *Target ContainerID* field, update the target container ID.
. Click *Retrieve Definition from backend*, and click *Next*.
+
image::processes/pim-migration-wizard.png[align="center"]

. From the *Source Nodes* list, select the source node you want to map.
. From the *Target Nodes* list, select the target node you want to map.
. If the *Source Process Definition Diagram* pane is not displayed, click *Show Source Diagram*.
. If the *Target Process Definition Diagram* pane is not displayed, click *Show Target Diagram*.
. Optionally, to modify the view in the diagram panes, do any of the following tasks:
* To select text, select the image:processes/pim-selection-icon.png[] icon.
* To pan, select the image:processes/pim-pan-icon.png[] icon.
* To zoom in, select the image:processes/pim-zoom-in-icon.png[] icon.
* To zoom out, select the image:processes/pim-zoom-out-icon.png[] icon.
* To fit to viewer, select the image:processes/pim-pan-icon.png[] icon.
. Click *Next*.
. Optional: To export as a `JSON` file, click *Export*.
. In the *Review & Submit* tab, review the plan and click *Submit Plan*.
. Optional: To export as a `JSON` file, click *Export*.
. Review the response and click *Close*.

== Executing a migration plan

You can execute the process instance migration plan.

.Prerequisites
* You have defined processes in a backuped {PRODUCT} development environment.
* The process instance migration service is running.

.Procedure
. Open the following address in a web browser:
+
----
localhost:3000
----
. Log in to the Process Instance Migration service.
. On the *Process Instance Migration* page, select the *Execute Migration Plan* image:processes/pim-execute-icon.png[] icon on the row of the migration plan you want to execute. The *Execute Migration Plan Wizard* window opens.
. From the migration plan table, select the check box on the row of each running process instance you want to migrate, and click *Next*.
. In the *Callback URL* field, enter the callback URL.
. To the right of *Run migration*, perform one of the following tasks:
* To execute the migration immediately, select *Now*.
* To schedule the migration, select *Schedule* and in the text field, enter the date and time, for example `06/20/2019 10:00 PM`.
. Click *Next*.
. Optional: To export as a `JSON` file, click *Export*.
. Click *Execute Plan*.
. Optional: To export as a `JSON` file, click *Export*.
. Check the response and click *Close*.

== Exporting a migration plan

You can export the process instance migration plan.

.Prerequisites
* You have defined processes in a backuped {PRODUCT} development environment.
* The process instance migration service is running.

.Procedure
. Open the following address in a web browser:
+
----
localhost:3000
----
. Log in to the Process Instance Migration service.
. On the *Process Instance Migration* page, select the *Export Migration Plan* image:processes/pim-execute-icon.png[] icon on the row of the migration plan you want to execute. The *Export Migration Plan* window opens.
. Review and click *Export*.

== Deleting a migration plan

You can delete a process instance migration plan.

.Prerequisites
* You have defined processes in a backuped {PRODUCT} development environment.
* The process instance migration service is running.

.Procedure
. Open the following address in a web browser:
+
----
localhost:3000
----
. Log in to the Process Instance Migration service.
. On the *Process Instance Migration* page, select the *Delete* image:processes/pim-delete-icon.png[] icon on the row of the migration plan you want to delete. The *Delete Migration Plan* window opens.
. Click *Delete* to confirm deletion.

== Editing a migration plan

You can edit a process instance migration plan.

.Prerequisites
* You have defined processes in a backuped {PRODUCT} development environment.
* The process instance migration service is running.

.Procedure
. Open the following address in a web browser:
+
----
localhost:3000
----
. Log in to the Process Instance Migration service.
. On the *Process Instance Migration* page, select the *Edit Migration Plan* image:processes/pim-edit-icon.png[] icon on the row of the migration plan you want to edit. The *Edit Migration Plan* window opens.
. On each tab, modify the details you want to change.
. Click *Next*.
. Optional: To export as a `JSON` file, click *Export*.
. In the *Review & Submit* tab, review the plan and click *Submit Plan*.
. Optional: To export as a `JSON` file, click *Export*.
. Review the response and click *Close*.
